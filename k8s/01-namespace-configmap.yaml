apiVersion: v1
kind: Namespace
metadata:
  name: trilix
  labels:
    name: trilix
---
apiVersion: v1
kind: ConfigMap
metadata:
  name: trilix-config
  namespace: trilix
data:
  # RabbitMQ connection
  RABBITMQ_HOST: "rabbitmq-0.rabbitmq.trilix.svc.cluster.local"
  RABBITMQ_PORT: "5672"
  RABBITMQ_VHOST: "trilix"
  
  # PostgreSQL connection
  POSTGRES_HOST: "aws-1-eu-west-1.pooler.supabase.com"
  POSTGRES_PORT: "5432"
  POSTGRES_DB: "postgres"
  
  # Service ports
  MCP_SERVER_PORT: "3000"
  
  # Paths for containerized environment
  ENV_FILE_PATH: ""  # Empty - use K8s env vars
  FRONTEND_PATH: "/root/frontend"

  # OAuth (Authorization Server)
  OAUTH_ISSUER: "https://trilix-eso.aws.providentiaworldwide.com"
  OAUTH_AUDIENCE: "https://trilix-eso.aws.providentiaworldwide.com"
  OAUTH_DCR_MODE: "protected"
  OAUTH_ACCESS_TOKEN_TTL: "1m"
  OAUTH_REFRESH_TOKEN_TTL: "2m"
  OAUTH_AUTH_CODE_TTL: "10m"
  OAUTH_DB_MAX_OPEN_CONNS: "2"
  OAUTH_DB_MAX_IDLE_CONNS: "1"
  OAUTH_DB_CONN_MAX_LIFETIME: "2m"

  # OAuth private key location (mounted secret)
  OAUTH_PRIVATE_KEY_PATH: "/var/run/secrets/oauth/oauth-private-key.pem"
