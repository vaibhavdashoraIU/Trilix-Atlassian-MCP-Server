# ============================================
# Trilix Atlassian MCP Server Configuration
# ============================================
# Copy this file to .env and update the values as needed
# The .env file is gitignored and will not be committed

# ============================================
# Workspace Configuration (Storage Choice)
# ============================================
# OPTION A: File-based storage (local development)
# Set WORKSPACES_FILE to use .config/workspaces.json
# WORKSPACES_FILE=.config/workspaces.json

# OPTION B: Database storage (Supabase / Production)
# To use database storage:
# 1. Comment out WORKSPACES_FILE above
# 2. Set DATABASE_URL and API_KEY_ENCRYPTION_KEY below
# WORKSPACES_FILE defines priority! If it's set, DATABASE_URL is ignored.

# ============================================
# RabbitMQ Configuration
# ============================================
RABBITMQ_HOST=localhost
RABBITMQ_VHOST=trilix
RABBITMQ_USER=trilix
RABBITMQ_PASSWORD=secret

# ============================================
# PostgreSQL (Credential Storage - Optional)
# ============================================
# Only needed if WORKSPACES_FILE is not set
# If WORKSPACES_FILE is set, these will be ignored
DATABASE_URL=postgres://trilix:secret@localhost:5432/trilix_mcp

# ============================================
# Clerk Authentication (Required for Production)
# ============================================
# Get your Clerk secret key from https://dashboard.clerk.com
# Format: sk_test_... (for development) or sk_live_... (for production)
CLERK_SECRET_KEY=sk_test_xxxxx

# Clerk publishable key for OAuth authorize UI
CLERK_PUBLISHABLE_KEY=pk_test_xxxxx

# Optional: Custom JWKS URL (defaults to https://api.clerk.com/v1/jwks)
# Only change this if you're using a custom Clerk instance
# CLERK_JWKS_URL=https://api.clerk.com/v1/jwks

# ============================================
# Security
# ============================================
# API_KEY_ENCRYPTION_KEY is only required when using DATABASE_URL
# Must be a 32-byte key (64 hex characters or 44 base64 characters)
# Generate with: openssl rand -hex 32
# Or on Windows PowerShell: [Convert]::ToBase64String((1..32 | ForEach-Object { Get-Random -Minimum 0 -Maximum 256 }))
API_KEY_ENCRYPTION_KEY=your-32-byte-key-here

# ============================================
# OAuth 2.1 Authorization Server (Required for LLMs)
# ============================================
# Issuer must match your public auth domain in production.
OAUTH_ISSUER=https://trilix-eso-auth.aws.providentiaworldwide.com
OAUTH_AUDIENCE=https://trilix-eso-auth.aws.providentiaworldwide.com

# Provide the RSA private key via PEM or file path.
# OAUTH_PRIVATE_KEY_PEM="-----BEGIN PRIVATE KEY-----\n...\n-----END PRIVATE KEY-----"
# OAUTH_PRIVATE_KEY_PATH=/path/to/oauth-private-key.pem

# Dynamic Client Registration (DCR)
OAUTH_DCR_MODE=protected
OAUTH_DCR_ACCESS_TOKEN=change-me

# Token lifetimes
OAUTH_ACCESS_TOKEN_TTL=60m
OAUTH_REFRESH_TOKEN_TTL=720h
OAUTH_AUTH_CODE_TTL=10m

# Optional: Clerk JS loader URL for the OAuth login page
# CLERK_JS_URL=https://cdn.jsdelivr.net/npm/@clerk/clerk-js@latest/dist/clerk.browser.js

# ============================================
# Redis (OAuth auth codes + sessions)
# ============================================
REDIS_URL=redis://localhost:6379/0

# ============================================
# Service Configuration (Optional)
# ============================================
# LOG_LEVEL=info
# ENVIRONMENT=development
